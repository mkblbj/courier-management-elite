# 用户故事：实现按店铺统计功能

作为系统用户，我希望能够按店铺查看出力数据统计，以便了解各个店铺的具体出力情况，从而进行精细化管理。

## 验收标准

1. 在出力统计页面中，当选择"按店铺"维度时，系统显示各个店铺的出力统计数据
2. 统计数据以表格形式展示，包含以下列：
   - 店铺名称
   - 所属类别
   - 总出力量
   - 占比（百分比）
   - 日均出力量
3. 同时提供数据可视化展示，使用柱状图或饼图显示各店铺的出力量和占比
4. 支持按日期范围筛选，用户可选择特定时间段的数据进行查看
5. 支持按店铺类别筛选，查看特定类别下的店铺分布
6. 支持按快递类型筛选，查看各店铺在特定快递类型上的出力情况
7. 图表和表格数据一致，随筛选条件变化而同步更新
8. 当选择特定类别时，柱状图中同一类别的店铺应使用相似的颜色进行分组显示

## 技术需求

1. 创建按店铺统计的表格组件，使用 shadcn/ui 的 Table 组件
2. 创建数据可视化图表，使用 Recharts 库实现柱状图和饼图
3. 实现数据加载逻辑，根据筛选条件调用相应的 API 接口
4. 实现数据计算逻辑，包括占比和日均量的计算
5. 添加表格排序功能，支持按不同列进行排序
6. 实现表格分页功能，当店铺数量较多时保持页面整洁
7. 实现按类别对店铺进行分组显示的功能，在表格和图表中体现

## 实现建议

1. 柱状图应显示各店铺的出力总量，使用不同颜色区分不同类别的店铺
2. 饼图应显示各店铺的出力占比，悬停时显示具体数值和百分比
3. 表格应支持排序功能，默认按出力总量降序排列
4. 表格应按店铺类别分组显示，相同类别的店铺放在一起
5. 图表应有明确的坐标轴标签、图例和数据标签
6. 当店铺数量较多时，可以考虑只显示 top N 的店铺，其余归为"其他"类别

## UI 参考

```
+----------------------------------------+
|  统计维度: ... [按店铺] ...             |
|                                        |
|  日期范围: [2023-05-01] 至 [2023-05-31] |
|  店铺类别: [所有类别 ▼]                 |
|  快递类型: [所有类型 ▼]                 |
|                                        |
|  [生成统计]                             |
+----------------------------------------+
|                                        |
|  [店铺出力分布柱状图]    [店铺占比饼图]  |
|                                        |
+----------------------------------------+
|  店铺出力数据                           |
|  +---------------------------------+   |
|  | 店铺名称 | 类别 | 总量 | 占比 | 日均 |   |
|  +---------------------------------+   |
|  | 淘宝店铺1 | 淘宝 | 300  | 26% | 10  |   |
|  | 淘宝店铺2 | 淘宝 | 220  | 19% | 7   |   |
|  | 京东旗舰 | 京东 | 320  | 28% | 10  |   |
|  | 拼多多店 | 拼多多 | 310 | 27% | 10 |   |
|  +---------------------------------+   |
|                                        |
+----------------------------------------+
```

## API 接口

需要与以下 API 接口集成：

```typescript
// 按店铺统计
GET /api/stats/shop-outputs/shops
请求参数：
{
  date_from?: string,
  date_to?: string,
  category_id?: number,
  courier_id?: number
}
响应:
{
  success: boolean,
  data: [
    {
      shop_id: number,
      shop_name: string,
      category_id: number,
      category_name: string,
      total_quantity: number,
      percentage: number,
      daily_average: number
    },
    // ...
  ]
}
```
