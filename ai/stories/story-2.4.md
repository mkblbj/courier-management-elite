# Story 2.4: 店铺删除功能

## Story

**As a** 系统管理员  
**I want** 能够删除不再需要的店铺信息  
**so that** 我可以保持店铺列表的整洁，只显示当前活跃或相关的店铺。

## Status

complete

## Context

随着业务变化，某些店铺可能不再需要在系统中管理。本故事将实现删除店铺的功能，允许管理员从系统中移除不再需要的店铺记录。

考虑到删除操作的不可逆性，需要添加确认机制，防止误操作导致数据丢失。此外，需要考虑已有出力数据与店铺的关联关系，确保数据完整性。

## Estimation

Story Points: 2

## Acceptance Criteria

1. - [ ] 在店铺列表中的每一行添加"删除"按钮
2. - [ ] 点击"删除"按钮时，弹出删除确认对话框
3. - [ ] 确认对话框显示警告信息，提醒用户删除操作的影响
4. - [ ] 对话框中显示将要删除的店铺名称，确保用户知道具体要删除的是哪个店铺
5. - [ ] 如果店铺已有关联的出力数据，应显示警告信息，告知用户删除后相关数据也将一并删除
6. - [ ] 确认对话框底部有"取消"和"确认删除"按钮
7. - [ ] 点击"确认删除"按钮后显示加载状态
8. - [ ] 删除成功后关闭对话框，并从列表中移除该店铺
9. - [ ] 删除失败时显示错误消息
10. - [ ] 删除完成后显示操作结果的通知消息
11. - [ ] 整体视觉风格与系统的其他对话框保持一致

## Subtasks

1. - [ ] 创建删除确认对话框组件
   1. - [ ] 使用 shadcn/ui 的 AlertDialog 组件创建对话框
   2. - [ ] 实现对话框内容，包括警告信息和店铺名称显示
   3. - [ ] 添加取消和确认删除按钮
2. - [ ] 实现删除店铺 API 集成
   1. - [ ] 完善 lib/api/shop.ts 中的删除店铺 API
   2. - [ ] 在确认删除时调用删除 API
   3. - [ ] 实现加载状态和错误处理
3. - [ ] 更新店铺列表组件
   1. - [ ] 添加行级"删除"按钮
   2. - [ ] 集成删除确认对话框
   3. - [ ] 实现删除成功后的列表更新逻辑
4. - [ ] 实现通知功能
   1. - [ ] 集成 shadcn/ui 的 Toast 组件
   2. - [ ] 添加删除成功/失败的通知消息
5. - [ ] 样式优化和交互完善
   1. - [ ] 确保删除按钮的样式与其危险操作性质相符
   2. - [ ] 优化确认对话框的警告视觉效果

## Testing Requirements:

- 单元测试覆盖率 >= 85%
- 对删除确认对话框进行组件测试
- 测试删除功能的 API 集成是否正确
- 测试删除店铺后列表更新的正确性
- 测试删除操作的各种场景（成功、失败、有关联数据等）
- 进行手动测试，验证用户交互体验和确认流程

## Notes

- 删除按钮应使用红色或其他警示色，表明这是危险操作
- 确认删除按钮文字应明确表示"删除"而非通用的"确认"
- 删除确认对话框应有明显的警告图标
- 考虑添加对已有关联出力数据的检查，并在确认对话框中显示相关信息
- 技术实现上可能需要考虑软删除机制，而非直接从数据库中删除记录
