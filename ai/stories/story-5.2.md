# Story 5.2: 明日出力卡片

## Story

**As a** 系统管理员  
**I want** 在仪表盘上看到明日各店铺的已录入出力情况  
**so that** 我可以提前了解业务，做好资源调配和准备工作。

## Status

未开始

## Context

显示明日的业务情况对于资源规划和业务安排至关重要。通过在仪表盘上添加明日店铺出力卡片，用户可以一目了然地看到即将到来的业务量，及时做出相应的安排和调整。

明日出力卡片将展示所有店铺次日的已经录入系统的出力总量、各类别的出力分布以及各店铺的详细数据，支持按类别筛选，帮助用户提前规划工作。

## Estimation

Story Points: 3

## Acceptance Criteria

1. - [ ] 在/dashboard 页面添加"明日店铺出力"卡片
2. - [ ] 卡片顶部显示明日总出力量，使用大号字体突出显示
3. - [ ] 卡片中部显示各店铺类别明日出力分布的饼图
4. - [ ] 卡片中部显示各店铺明日出力分布的饼图，支持按类别筛选
5. - [ ] 卡片底部显示各店铺明日出力量和占比的表格，按类别分组
6. - [ ] 实现自动刷新机制，定期更新数据（默认 5 分钟刷新一次）
7. - [ ] 添加手动刷新按钮，点击后立即更新数据
8. - [ ] 数据加载过程中显示加载状态
9. - [ ] 当没有数据时，显示"暂无数据"提示
10. - [ ] 卡片的视觉设计应与系统的整体风格保持一致，并与今日出力卡片风格统一
11. - [ ] 在移动设备上能够良好展示
12. - [ ] 通过视觉设计明确表示这是明日数据，而非当日数据

## Subtasks

1. - [ ] 创建明日出力卡片组件
   1. - [ ] 在 `app/dashboard/components/ShopOutputTomorrowCard.tsx` 中实现明日出力卡片组件
   2. - [ ] 实现饼图组件，集成图表库
   3. - [ ] 实现店铺明日数据表格组件
2. - [ ] 实现数据获取和处理
   1. - [ ] 创建获取明日出力数据的服务函数
   2. - [ ] 实现数据加载和错误处理
   3. - [ ] 实现数据按类别和店铺的分组统计
3. - [ ] 实现数据可视化
   1. - [ ] 集成 Recharts 库
   2. - [ ] 实现类别分布饼图，使用不同于今日数据的配色方案
   3. - [ ] 实现店铺分布饼图，使用不同于今日数据的配色方案
   4. - [ ] 添加图表交互功能，如悬停显示详情
4. - [ ] 实现筛选功能
   1. - [ ] 添加类别筛选下拉框
   2. - [ ] 实现按类别筛选店铺数据的逻辑
   3. - [ ] 确保筛选后图表和表格数据同步更新
5. - [ ] 实现自动刷新机制
   1. - [ ] 创建定时器，定期刷新数据
   2. - [ ] 添加手动刷新按钮
   3. - [ ] 确保组件卸载时清除定时器
6. - [ ] 集成到仪表盘页面
   1. - [ ] 将卡片组件集成到仪表盘布局，放置在今日出力卡片旁边
   2. - [ ] 调整卡片尺寸和位置
   3. - [ ] 确保与今日出力卡片的视觉协调性
7. - [ ] 实现响应式布局
   1. - [ ] 优化卡片在不同屏幕尺寸下的显示
   2. - [ ] 确保图表在小屏幕上仍能清晰显示
   3. - [ ] 测试不同设备下的展示效果
8. - [ ] 样式优化
   1. - [ ] 设计卡片样式，添加明日数据的视觉标识
   2. - [ ] 优化图表颜色和样式，确保与今日出力卡片有所区分
   3. - [ ] 添加适当的动画和过渡效果

## Testing Requirements:

- 单元测试覆盖率 >= 85%
- 对卡片组件进行组件测试，验证渲染和数据展示
- 测试数据统计逻辑的准确性
- 测试筛选功能
- 测试图表的渲染和交互
- 测试自动刷新和手动刷新功能
- 测试组件在不同数据状态下的显示（空数据、加载中、错误等）
- 进行手动测试，验证在不同屏幕尺寸下的用户体验
- 测试与今日出力卡片的交互和视觉一致性

## Notes

- 使用 shadcn/ui 的 Card 组件实现出力卡片
- 使用 Recharts 实现数据可视化图表
- 图表颜色应采用系统配色方案，但与今日出力卡片有所区分
- 可以使用虚线边框或添加日历图标，明确表示这是明日数据
- 参考 v0dev_prompt_shop_output_management.md 中的第 12 点"明日店铺出力卡片组件"设计
- 确保数据刷新时有适当的视觉反馈，但不要打断用户操作
- 考虑添加"查看更多"链接，跳转到出力数据详情页面
- 数据表格标题使用"明日出力"而非"出力量"，强调这是未来数据
