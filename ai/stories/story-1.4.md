# Story 1.4: 店铺删除功能

## Story

**As a** 系统用户
**I want** 能够删除不再需要的店铺
**so that** 我可以保持系统中只有活跃的店铺数据，提高数据管理的清晰度。

## Status

complete

## Context

随着业务调整，某些店铺可能会关闭或不再需要管理其出力数据。系统需要提供删除功能，让用户能够移除这些不再需要的店铺数据。由于删除是一个敏感操作，系统需要提供确认机制，避免误操作导致数据丢失。

同时，考虑到数据完整性和历史记录的重要性，系统可能需要考虑"软删除"策略，即在用户界面中不再显示已删除的店铺，但在数据库中保留其记录，以便必要时恢复数据或查询历史。

## Estimation

Story Points: 1

## Acceptance Criteria

1. - [ ] 在店铺列表中为每个店铺提供"删除"按钮
2. - [ ] 点击删除按钮后显示确认对话框，警示用户此操作的风险
3. - [ ] 确认对话框中清晰说明删除操作的后果，如"删除后将无法查看该店铺的出力数据"
4. - [ ] 用户确认后执行删除操作，成功删除后从列表中移除该店铺
5. - [ ] 删除失败时显示适当的错误消息
6. - [ ] 确认对话框提供取消按钮，点击取消按钮关闭对话框，不执行删除操作
7. - [ ] 删除操作应记录在系统日志中，包括操作人和删除时间
8. - [ ] 已删除店铺的相关出力数据应根据业务规则处理（如保留或标记为无效）

## Subtasks

1. - [ ] 创建删除确认对话框
   1. - [ ] 创建 DeleteConfirmDialog.tsx 组件
   2. - [ ] 设计对话框 UI，清晰说明删除风险
   3. - [ ] 实现确认和取消按钮逻辑
2. - [ ] 实现删除功能
   1. - [ ] 在 ShopList.tsx 中为每个店铺添加"删除"按钮
   2. - [ ] 实现删除确认对话框的打开和关闭逻辑
   3. - [ ] 实现删除请求的发送和响应处理
   4. - [ ] 实现错误处理和成功反馈
3. - [ ] 完善 API 调用
   1. - [ ] 在 shop.ts API 服务中实现删除店铺的方法
   2. - [ ] 确保 API 错误能够被正确捕获和处理
4. - [ ] 实现列表更新
   1. - [ ] 删除成功后自动从列表中移除该店铺
   2. - [ ] 确保删除操作不影响其他店铺的显示
5. - [ ] 添加单元测试
   1. - [ ] 测试删除确认对话框的显示和交互逻辑
   2. - [ ] 测试删除功能的成功和失败场景
   3. - [ ] 测试删除后列表状态的正确更新

## Testing Requirements:

- 确保组件测试覆盖率 >= 85%
- 测试删除确认对话框的显示和交互
- 测试 API 调用失败时的错误处理
- 测试成功删除后列表的更新逻辑
- 验证所有 UI 交互符合产品设计规范
- 测试取消删除功能是否正确保留数据

## Story Wrap Up (To be filled in AFTER agent execution):

- **Agent Model Used:** `<Agent Model Name/Version>`
- **Agent Credit or Cost:** `<Cost/Credits Consumed>`
- **Date/Time Completed:** `<Timestamp>`
- **Commit Hash:** `<Git Commit Hash of resulting code>`
- **Change Log**
  - 创建删除确认对话框组件
  - 实现删除功能
  - 完善 API 调用
  - 实现列表更新逻辑
  - 添加单元测试
