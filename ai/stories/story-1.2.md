# Story 1.2: 店铺类别添加功能

## Story

**As a** 系统管理员  
**I want** 能够添加新的店铺类别  
**so that** 我可以对店铺进行分类管理，使系统更有条理。

## Status

complete

## Context

店铺类别是店铺管理的基础，用户需要能够在系统中创建新的店铺类别。这个功能将在完成店铺类别列表展示（Story 1.1）之后实现，允许用户通过简单的表单界面添加新的店铺类别。

本故事将实现添加新店铺类别的功能，包括创建添加类别按钮、添加类别对话框、表单验证以及与后端 API 的交互，确保用户能够方便地添加新的店铺类别信息。

## Estimation

Story Points: 2

## Acceptance Criteria

1. - [ ] 在店铺类别列表页面添加"添加类别"按钮，位于表格上方
2. - [ ] 点击"添加类别"按钮打开添加类别对话框
3. - [ ] 添加类别对话框包含以下内容：
   - 对话框标题："添加店铺类别"
   - 类别名称输入框（必填）
   - 取消按钮和确认按钮
4. - [ ] 实现表单验证，包括：
   - 类别名称不能为空
   - 类别名称最大长度限制（255 字符）
   - 显示适当的错误提示
5. - [ ] 点击确认按钮时，向后端 API 发送创建请求
6. - [ ] 创建成功后：
   - 关闭对话框
   - 刷新类别列表
   - 显示成功消息
7. - [ ] 创建失败时显示错误消息
8. - [ ] 点击取消按钮关闭对话框，不进行任何操作
9. - [ ] 对话框的整体视觉风格与系统保持一致

## Subtasks

1. - [ ] 实现"添加类别"按钮
   1. - [ ] 在 CategoryList.tsx 组件中添加按钮
   2. - [ ] 设计按钮样式和位置
   3. - [ ] 实现点击事件处理
2. - [ ] 实现添加类别对话框
   1. - [ ] 完善 components/shop-category/CategoryForm.tsx 组件
   2. - [ ] 创建对话框组件，集成表单
   3. - [ ] 实现对话框打开和关闭逻辑
3. - [ ] 实现表单逻辑
   1. - [ ] 创建表单状态管理
   2. - [ ] 实现表单验证规则
   3. - [ ] 添加错误提示显示
4. - [ ] 实现 API 交互
   1. - [ ] 在 lib/api/shop-category.ts 中实现创建类别 API
   2. - [ ] 在表单组件中集成 API 调用
   3. - [ ] 实现加载状态和错误处理
5. - [ ] 实现成功/失败提示
   1. - [ ] 添加 Toast 提示组件
   2. - [ ] 在不同操作结果下显示适当的提示
6. - [ ] 实现列表刷新逻辑
   1. - [ ] 创建类别成功后刷新列表数据
   2. - [ ] 确保新添加的类别在列表中可见

## Testing Requirements:

- 单元测试覆盖率 >= 85%
- 对表单组件进行组件测试，验证表单验证逻辑
- 测试 API 集成是否正确
- 模拟 API 成功和失败的情况，测试错误处理
- 验证表单提交后的状态更新和 UI 变化

## Notes

- 使用 shadcn/ui 的 Dialog 组件实现对话框
- 使用 shadcn/ui 的 Form 组件和 Input 组件实现表单
- 使用 React Hook Form 进行表单状态管理
- 使用 Zod 进行表单验证
- 参考 v0dev 生成的店铺类别添加/编辑对话框组件设计
