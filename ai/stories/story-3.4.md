# Story 3.4: 最近录入数据展示

## Story

**As a** 系统管理员  
**I want** 能够查看最近录入的出力数据记录并进行筛选  
**so that** 我可以快速核对刚刚录入的数据，确保数据准确性，按不同条件查看数据，并在需要时进行编辑或删除。

## Status

processing

## Context

用户在录入出力数据后，需要及时看到反馈，确认数据是否正确录入。本故事将实现最近录入的出力数据展示功能，默认显示当天录入的数据记录，并支持按多种条件进行筛选，方便用户进行核对和管理。

最近录入数据展示区域将以表格形式展示数据，默认按店铺类型分组展示，支持按日期范围、快递类型、店铺类型、具体店铺进行筛选，并提供编辑和删除功能，方便用户管理这些记录。页面设计将参考 shipping-data 页面的最近录入记录组件样式。

## Estimation

Story Points: 3

## Acceptance Criteria

1. - [ ] 在出力数据页面下部实现"最近录入数据"区域，以表格形式展示
2. - [ ] 默认显示当天录入的出力数据记录，按店铺类型分组展示
3. - [ ] 表格包含以下列：
   - 日期
   - 店铺名称
   - 快递类型
   - 数量
   - 备注（如果有）
   - 操作按钮（编辑、删除）
4. - [ ] 支持按日期范围进行筛选
5. - [ ] 支持按快递类型进行筛选
6. - [ ] 支持按店铺类型和具体店铺进行筛选
7. - [ ] 表格顶部显示当前筛选条件的汇总信息
8. - [ ] 提供刷新按钮，点击后重新加载最新数据
9. - [ ] 当没有数据时，显示"暂无数据"提示
10. - [ ] 数据加载过程中显示加载状态
11. - [ ] 表格底部显示总记录数信息并支持分页功能
12. - [ ] 设计风格应参考 shipping-data 页面的最近录入记录组件
13. - [ ] 表格在移动设备上应能够水平滚动，确保所有数据可见

## Subtasks

1. - [ ] 创建最近录入数据表格组件
   1. - [ ] 在 `app/output-data/components/OutputList.tsx` 中实现数据表格组件
   2. - [ ] 定义表格列配置
   3. - [ ] 实现表格头部和数据行的渲染
   4. - [ ] 添加分页控件
   5. - [ ] 添加刷新按钮
2. - [ ] 实现数据筛选功能
   1. - [ ] 添加日期范围选择器
   2. - [ ] 添加快递类型选择器
   3. - [ ] 添加店铺类型和店铺选择器
   4. - [ ] 实现筛选条件的汇总展示
   5. - [ ] 实现筛选条件的重置功能
3. - [ ] 实现数据加载和分组展示功能
   1. - [ ] 创建获取最近录入数据的 API 接口
   2. - [ ] 实现按店铺类型分组展示数据
   3. - [ ] 实现数据加载和错误处理
   4. - [ ] 添加加载状态指示器
   5. - [ ] 处理空数据情况
4. - [ ] 实现数据分页逻辑
   1. - [ ] 实现分页参数处理
   2. - [ ] 实现页码切换功能
   3. - [ ] 添加每页显示条数选择器
   4. - [ ] 确保分页与服务端分页一致
5. - [ ] 添加操作按钮
   1. - [ ] 添加编辑按钮，对接后续编辑功能
   2. - [ ] 添加删除按钮，对接后续删除功能
   3. - [ ] 实现按钮的基本样式和布局
6. - [ ] 实现数据实时更新
   1. - [ ] 在表单提交成功后，自动刷新表格数据
   2. - [ ] 确保新添加的记录能够立即显示在表格中
7. - [ ] 参考 recent-entries.tsx 组件样式进行实现
   1. - [ ] 分析 recent-entries.tsx 组件的结构和样式
   2. - [ ] 应用相同的设计模式和 UI 交互
   3. - [ ] 确保组件之间的视觉一致性
8. - [ ] 样式优化和响应式设计
   1. - [ ] 实现表格的响应式布局
   2. - [ ] 优化表格在不同屏幕尺寸下的显示效果
   3. - [ ] 确保移动端可以水平滚动查看完整表格

## Testing Requirements:

- 单元测试覆盖率 >= 85%
- 对表格组件进行组件测试，验证渲染和数据展示
- 测试数据加载和分页功能
- 测试筛选功能的组合使用
- 测试空数据状态和加载状态的显示
- 测试新数据添加后表格的更新逻辑
- 测试表格在不同屏幕尺寸下的响应式布局
- 进行手动测试，验证表格的用户体验和交互效果

## Notes

- 使用 shadcn/ui 的 Table 组件实现数据表格
- 使用 shadcn/ui 的 Button 和 Select 组件实现操作按钮和筛选控件
- 使用 DateSelector 组件实现日期选择，并优化日历界面（移除星期显示以减少视觉拥挤）
- 实现了按店铺类别分组显示的功能，提高数据可读性
- 修复了日期筛选功能，确保正确传递和处理 output_date 参数
- 增强了店铺分组筛选功能，使筛选结果准确反映所选条件
- 添加了丰富的筛选条件展示，包括日期、快递类型、店铺类型和具体店铺
- 改进了后端 API，使其能够正确处理 output_date 参数
- 实现了前端筛选逻辑，处理后端 API 可能不支持的筛选条件（如类别筛选）
- 添加了实时刷新和清除筛选条件的功能
- 优化了数据加载过程中的骨架屏显示
- 实现了编辑和删除记录的功能，并添加了确认对话框
- 整体界面遵循了一致的设计语言，与系统其他部分保持统一
