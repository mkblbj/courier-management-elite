# Story 1.6: 店铺排序功能

## Story

**As a** 系统用户
**I want** 能够调整店铺的显示顺序
**so that** 我可以将常用或重要的店铺放在列表前面，提高工作效率。

## Status

complete

## Context

在日常使用中，用户可能会有固定的工作习惯，例如先处理某些特定店铺的数据。通过排序功能，用户可以按照自己的偏好调整店铺的显示顺序，将常用或重要的店铺放在列表前面，减少查找时间，提高工作效率。

排序功能需要设计直观且易用，如通过拖拽方式调整顺序。由于排序需要调整多个项目的顺序，应该采用专门的排序模态框或页面，让用户能够集中精力完成排序操作。同时，排序后的结果需要在所有用户之间同步，避免不同用户看到不同的顺序导致沟通混乱。

## Estimation

Story Points: 2

## Acceptance Criteria

1. - [ ] 在店铺管理页面提供"调整排序"按钮
2. - [ ] 点击"调整排序"按钮后打开排序模态框
3. - [ ] 排序模态框中显示所有店铺，并支持拖拽调整顺序
4. - [ ] 拖拽过程中提供视觉反馈，如高亮拖拽中的项目
5. - [ ] 模态框中提供"保存"和"取消"按钮
6. - [ ] 点击"保存"按钮后，系统保存新的排序顺序并关闭模态框
7. - [ ] 保存成功后，店铺列表按照新的顺序重新排列
8. - [ ] 保存失败时显示适当的错误消息
9. - [ ] 点击"取消"按钮时，关闭模态框不保存更改
10. - [ ] 排序操作应记录在系统日志中

## Subtasks

1. - [ ] 创建店铺排序模态框
   1. - [ ] 创建 ShopSortModal.tsx 组件
   2. - [ ] 实现模态框基本布局和样式
   3. - [ ] 集成可拖拽列表组件
   4. - [ ] 实现拖拽排序逻辑
2. - [ ] 实现排序功能
   1. - [ ] 在店铺管理页面添加"调整排序"按钮
   2. - [ ] 实现排序模态框的打开和关闭逻辑
   3. - [ ] 实现排序数据的提交和保存逻辑
   4. - [ ] 实现错误处理和成功反馈
3. - [ ] 完善 API 调用
   1. - [ ] 在 shop.ts API 服务中实现更新店铺排序的方法
   2. - [ ] 确保 API 错误能够被正确捕获和处理
   3. - [ ] 优化请求处理，可能需要批量更新多个店铺的顺序
4. - [ ] 优化用户体验
   1. - [ ] 添加拖拽过程中的视觉反馈
   2. - [ ] 实现保存过程中的加载指示器
   3. - [ ] 确保排序界面在各种屏幕尺寸下都能正常工作
5. - [ ] 添加单元测试
   1. - [ ] 测试排序模态框的显示和交互逻辑
   2. - [ ] 测试拖拽排序功能
   3. - [ ] 测试保存和取消功能
   4. - [ ] 测试 API 调用的成功和失败场景

## Testing Requirements:

- 确保组件测试覆盖率 >= 85%
- 测试排序模态框在不同屏幕尺寸下的响应式布局
- 测试拖拽排序功能的用户体验
- 测试 API 调用失败时的错误处理
- 测试大量店铺数据时的性能表现
- 验证所有 UI 交互符合产品设计规范

## Story Wrap Up (To be filled in AFTER agent execution):

- **Agent Model Used:** `<Agent Model Name/Version>`
- **Agent Credit or Cost:** `<Cost/Credits Consumed>`
- **Date/Time Completed:** `<Timestamp>`
- **Commit Hash:** `<Git Commit Hash of resulting code>`
- **Change Log**
  - 创建店铺排序模态框组件
  - 实现拖拽排序功能
  - 完善批量更新 API 调用
  - 优化排序界面用户体验
  - 添加单元测试
