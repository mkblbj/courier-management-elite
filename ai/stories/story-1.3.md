# Story 1.3: 店铺编辑功能

## Story

**As a** 系统用户
**I want** 能够编辑已有店铺的信息
**so that** 我可以修正错误或更新变化的店铺信息。

## Status

Draft

## Context

随着业务运营，店铺的信息可能会发生变化，如店铺名称修改、状态变更等。系统需要提供编辑功能，让用户能够方便地更新店铺信息。编辑功能是店铺管理的基本操作之一，将建立在店铺列表展示功能的基础上，通过对话框方式实现。

编辑功能需要加载现有的店铺信息，并允许用户在此基础上进行修改。系统需要对修改后的输入进行验证，确保数据的合法性，并在更新成功后及时反馈给用户。

## Estimation

Story Points: 1

## Acceptance Criteria

1. - [ ] 在店铺列表中为每个店铺提供"编辑"按钮
2. - [ ] 点击编辑按钮后打开编辑对话框，预填充现有店铺信息
3. - [ ] 编辑对话框包含与添加对话框相同的字段：店铺名称、备注、状态
4. - [ ] 实现表单验证，确保店铺名称不为空且长度合适
5. - [ ] 编辑成功后关闭对话框，并在列表中更新显示的店铺信息
6. - [ ] 编辑失败时显示适当的错误消息
7. - [ ] 对话框提供取消按钮，点击取消按钮关闭对话框，不保存更改
8. - [ ] 编辑操作应记录在系统日志中

## Subtasks

1. - [ ] 创建编辑店铺对话框组件
   1. - [ ] 复用 ShopForm.tsx 组件，作为添加和编辑的通用表单
   2. - [ ] 创建 EditShopDialog.tsx 组件，用于编辑店铺
   3. - [ ] 实现表单预填充逻辑
   4. - [ ] 确保表单验证逻辑适用于编辑场景
2. - [ ] 实现编辑店铺功能
   1. - [ ] 在 ShopList.tsx 中为每个店铺添加"编辑"按钮
   2. - [ ] 实现对话框的打开和关闭逻辑
   3. - [ ] 实现获取单个店铺详细信息的逻辑
   4. - [ ] 实现表单提交和更新逻辑
   5. - [ ] 实现错误处理和成功反馈
3. - [ ] 完善 API 调用
   1. - [ ] 在 shop.ts API 服务中实现获取单个店铺和更新店铺的方法
   2. - [ ] 确保 API 错误能够被正确捕获和处理
4. - [ ] 实现列表更新
   1. - [ ] 编辑成功后自动刷新列表或直接更新列表中的对应项
   2. - [ ] 确保更新后的店铺在列表中以高亮方式显示
5. - [ ] 添加单元测试
   1. - [ ] 测试表单预填充和验证逻辑
   2. - [ ] 测试编辑功能的成功和失败场景
   3. - [ ] 测试对话框的打开和关闭逻辑

## Testing Requirements:

- 确保组件测试覆盖率 >= 85%
- 测试表单验证在各种输入情况下的行为
- 测试 API 调用失败时的错误处理
- 测试成功编辑后列表的更新逻辑
- 验证所有 UI 交互符合产品设计规范
- 测试取消编辑功能是否正确保留原始数据

## Story Wrap Up (To be filled in AFTER agent execution):

- **Agent Model Used:** `<Agent Model Name/Version>`
- **Agent Credit or Cost:** `<Cost/Credits Consumed>`
- **Date/Time Completed:** `<Timestamp>`
- **Commit Hash:** `<Git Commit Hash of resulting code>`
- **Change Log**
  - 创建编辑店铺对话框组件
  - 实现表单预填充和验证逻辑
  - 实现编辑店铺功能
  - 完善 API 调用
  - 添加单元测试
