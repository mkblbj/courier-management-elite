# Story 1.3: 店铺类别编辑功能

## Story

**As a** 系统管理员  
**I want** 能够编辑现有的店铺类别信息  
**so that** 我可以修正错误或更新类别名称，保持系统数据的准确性。

## Status

complete

## Context

随着业务的发展，用户可能需要对已创建的店铺类别信息进行修改。这个功能将在完成店铺类别列表展示（Story 1.1）之后实现，允许用户通过简单的表单界面编辑现有的店铺类别信息。

本故事将实现编辑店铺类别信息的功能，包括在类别列表中添加编辑按钮、创建编辑对话框、表单验证以及与后端 API 的交互，确保用户能够方便地更新类别信息。

## Estimation

Story Points: 2

## Acceptance Criteria

1. - [ ] 在店铺类别列表的每一行添加"编辑"按钮
2. - [ ] 点击"编辑"按钮打开编辑类别对话框
3. - [ ] 编辑类别对话框包含以下内容：
   - 对话框标题："编辑店铺类别"
   - 类别名称输入框（必填，预填充当前类别名称）
   - 取消按钮和确认按钮
4. - [ ] 实现表单验证，包括：
   - 类别名称不能为空
   - 类别名称最大长度限制（255 字符）
   - 显示适当的错误提示
5. - [ ] 点击确认按钮时，向后端 API 发送更新请求
6. - [ ] 更新成功后：
   - 关闭对话框
   - 刷新类别列表
   - 显示成功消息
7. - [ ] 更新失败时显示错误消息
8. - [ ] 点击取消按钮关闭对话框，不进行任何操作
9. - [ ] 对话框的整体视觉风格与系统保持一致
10. - [ ] 确保编辑功能复用添加类别时使用的组件，保持代码的可维护性

## Subtasks

1. - [ ] 实现类别列表中的"编辑"按钮
   1. - [ ] 在 CategoryList.tsx 组件的每一行添加编辑按钮
   2. - [ ] 设计按钮样式和位置
   3. - [ ] 实现点击事件处理
2. - [ ] 调整 CategoryForm.tsx 组件支持编辑模式
   1. - [ ] 修改表单组件，支持初始值填充
   2. - [ ] 根据不同模式（添加/编辑）调整表单行为
   3. - [ ] 实现对话框标题动态变化
3. - [ ] 实现编辑对话框
   1. - [ ] 复用添加类别对话框组件，添加编辑模式
   2. - [ ] 实现对话框打开时加载类别数据
   3. - [ ] 处理编辑模式下的表单状态
4. - [ ] 实现 API 交互
   1. - [ ] 在 lib/api/shop-category.ts 中实现更新类别 API
   2. - [ ] 在表单组件中集成 API 调用
   3. - [ ] 实现加载状态和错误处理
5. - [ ] 实现成功/失败提示
   1. - [ ] 在不同操作结果下显示适当的提示
6. - [ ] 实现列表刷新逻辑
   1. - [ ] 更新类别成功后刷新列表数据
   2. - [ ] 确保编辑后的类别信息在列表中正确显示

## Testing Requirements:

- 单元测试覆盖率 >= 85%
- 对表单组件进行组件测试，验证编辑模式下的表单渲染和验证逻辑
- 测试 API 集成是否正确
- 模拟 API 成功和失败的情况，测试错误处理
- 验证表单提交后的状态更新和 UI 变化

## Notes

- 尽可能复用添加类别功能的表单组件，避免代码重复
- 使用 shadcn/ui 的 Dialog 组件实现对话框
- 使用 shadcn/ui 的 Form 组件和 Input 组件实现表单
- 使用 React Hook Form 进行表单状态管理
- 使用 Zod 进行表单验证
- 参考 v0dev 生成的店铺类别添加/编辑对话框组件设计
