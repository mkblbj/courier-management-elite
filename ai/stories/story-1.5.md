# Story 1.5: 店铺状态切换功能

## Story

**As a** 系统用户
**I want** 能够快速切换店铺的启用/禁用状态
**so that** 我可以灵活控制哪些店铺处于活跃状态，便于数据录入和管理。

## Status

complete

## Context

在日常管理中，用户需要根据业务需求灵活控制店铺的状态。例如，当某个店铺暂停营业时，可以将其设置为禁用状态，避免在数据录入时误选该店铺；当店铺恢复营业时，再将其设置为启用状态。这种状态切换功能需要设计得简单直观，让用户能够一目了然地看到店铺状态并进行操作。

与编辑功能不同，状态切换是一个高频且简单的操作，因此应设计成无需打开对话框即可完成的操作，如通过开关按钮直接切换。同时，系统需要提供适当的反馈，让用户知道操作是否成功。

## Estimation

Story Points: 1

## Acceptance Criteria

1. - [ ] 在店铺列表中为每个店铺提供状态切换开关
2. - [ ] 开关应清晰显示当前店铺的状态（启用/禁用）
3. - [ ] 点击开关时，系统应立即执行状态切换操作
4. - [ ] 切换过程中应显示加载指示器，防止用户重复点击
5. - [ ] 切换成功后更新开关状态，反映最新的店铺状态
6. - [ ] 切换失败时显示适当的错误消息，并恢复开关到原始状态
7. - [ ] 状态切换操作应记录在系统日志中
8. - [ ] 禁用状态的店铺应在列表中以灰色或其他适当的视觉样式显示，以区分于启用状态的店铺

## Subtasks

1. - [ ] 设计状态切换 UI
   1. - [ ] 在 ShopList.tsx 中添加状态切换开关组件
   2. - [ ] 确保开关的设计符合现有系统的 UI 风格
   3. - [ ] 实现启用/禁用状态的视觉差异
2. - [ ] 实现状态切换功能
   1. - [ ] 实现开关点击事件处理
   2. - [ ] 添加加载状态逻辑，防止重复点击
   3. - [ ] 实现状态切换请求的发送和响应处理
   4. - [ ] 实现错误处理和成功反馈
3. - [ ] 完善 API 调用
   1. - [ ] 在 shop.ts API 服务中实现切换店铺状态的方法
   2. - [ ] 确保 API 错误能够被正确捕获和处理
4. - [ ] 优化用户体验
   1. - [ ] 确保状态切换操作的响应速度足够快
   2. - [ ] 添加适当的动画效果，提升交互体验
   3. - [ ] 实现禁用状态店铺的视觉差异化显示
5. - [ ] 添加单元测试
   1. - [ ] 测试状态切换功能的成功和失败场景
   2. - [ ] 测试状态切换过程中的 UI 变化
   3. - [ ] 测试状态切换后列表显示的正确更新

## Testing Requirements:

- 确保组件测试覆盖率 >= 85%
- 测试状态切换在不同网络条件下的表现
- 测试 API 调用失败时的错误处理
- 测试成功切换后 UI 的更新逻辑
- 验证所有 UI 交互符合产品设计规范
- 测试多个同时状态切换请求的处理

## Story Wrap Up (To be filled in AFTER agent execution):

- **Agent Model Used:** `<Agent Model Name/Version>`
- **Agent Credit or Cost:** `<Cost/Credits Consumed>`
- **Date/Time Completed:** `<Timestamp>`
- **Commit Hash:** `<Git Commit Hash of resulting code>`
- **Change Log**
  - 设计状态切换 UI
  - 实现状态切换功能
  - 完善 API 调用
  - 优化用户体验
  - 添加单元测试
