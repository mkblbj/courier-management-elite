# Story 2.5: 店铺状态切换功能

## Story

**As a** 系统管理员  
**I want** 能够快速切换店铺的启用/禁用状态  
**so that** 我可以控制哪些店铺在系统中处于活跃状态，参与出力数据统计和分析。

## Status

not started

## Context

系统中的店铺可能处于不同的状态，有些店铺可能暂时不需要录入出力数据，但又不希望完全从系统中删除。本故事将实现店铺状态切换功能，允许管理员快速设置店铺的启用或禁用状态。

启用状态的店铺将参与正常的出力数据管理和统计，而禁用状态的店铺则不会在出力数据录入和统计分析中显示，但仍保留在系统中，以便将来可能的重新启用。

## Estimation

Story Points: 1

## Acceptance Criteria

1. - [ ] 在店铺列表中的每一行添加状态切换开关
2. - [ ] 状态开关清晰显示当前店铺的启用/禁用状态
3. - [ ] 点击状态开关时，立即显示切换中的状态（如加载动画）
4. - [ ] 状态切换成功后，更新开关显示
5. - [ ] 状态切换失败时，开关恢复到原状态，并显示错误消息
6. - [ ] 状态变更后，根据需要刷新列表，确保显示最新状态
7. - [ ] 状态切换完成后，显示操作结果的通知消息
8. - [ ] 禁用状态的店铺在列表中应有明显的视觉区分

## Subtasks

1. - [ ] 扩展店铺列表组件
   1. - [ ] 添加状态切换开关控件
   2. - [ ] 实现开关的样式和交互效果
   3. - [ ] 添加加载状态的视觉反馈
2. - [ ] 实现状态切换 API 集成
   1. - [ ] 完善 lib/api/shop.ts 中的切换店铺状态 API
   2. - [ ] 在状态切换时调用 API
   3. - [ ] 实现加载状态和错误处理
3. - [ ] 实现通知功能
   1. - [ ] 添加状态切换成功/失败的通知消息
4. - [ ] 样式优化和交互完善
   1. - [ ] 确保禁用状态的店铺有明显的视觉区分（如灰色背景或透明度）
   2. - [ ] 优化开关的视觉设计，使其含义直观清晰

## Testing Requirements:

- 单元测试覆盖率 >= 85%
- 对状态切换组件进行组件测试
- 测试状态切换的 API 集成是否正确
- 测试切换后店铺状态更新的正确性
- 测试状态切换操作的各种场景（成功、失败）
- 进行手动测试，验证用户交互体验和视觉反馈

## Notes

- 使用 shadcn/ui 的 Switch 组件实现状态切换开关
- 状态开关应设计得直观，例如绿色表示启用，灰色表示禁用
- 考虑添加状态切换时的确认机制，特别是当从启用切换到禁用时
- 禁用状态的店铺应在与出力数据相关的功能中被过滤掉，如出力数据录入时的店铺选择
- 实现时要注意开关组件的无障碍支持，确保可以通过键盘操作
