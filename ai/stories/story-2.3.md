# Story 2.3: 店铺编辑功能

## Story

**As a** 系统管理员  
**I want** 能够编辑现有店铺的信息  
**so that** 我可以修正或更新店铺的名称、类别、备注和状态等信息。

## Status

not started

## Context

系统中已有的店铺信息可能需要更新，如店铺更名、变更所属类别、修改状态等。本故事将实现编辑现有店铺信息的功能，确保系统中的店铺数据保持最新和准确。

编辑功能将复用与添加功能相似的表单组件，但需要预填充现有店铺的信息，并在提交时执行更新而非创建操作。

## Estimation

Story Points: 2

## Acceptance Criteria

1. - [ ] 在店铺列表中的每一行添加"编辑"按钮
2. - [ ] 点击"编辑"按钮时，弹出编辑店铺对话框
3. - [ ] 编辑店铺对话框与添加对话框结构相同，包含以下预填充的字段：
   - 店铺名称（必填文本输入框）
   - 所属类别（必选下拉选择框，显示所有可用类别）
   - 备注（可选多行文本框）
   - 状态（单选按钮组，选项为"启用"和"禁用"）
4. - [ ] 对话框打开时自动加载并显示当前店铺的信息
5. - [ ] 实现表单验证逻辑，与添加功能相同
6. - [ ] 表单提交时显示加载状态
7. - [ ] 提交成功后关闭对话框，并在列表中更新编辑后的店铺信息
8. - [ ] 提交失败时显示错误消息
9. - [ ] 对话框底部有"取消"和"确认"按钮，点击"取消"或对话框外部可关闭对话框
10. - [ ] 对话框的视觉设计与添加店铺对话框保持一致

## Subtasks

1. - [ ] 扩展店铺表单组件以支持编辑模式
   1. - [ ] 在 ShopForm.tsx 中添加初始值支持
   2. - [ ] 确保所有字段能正确显示和编辑现有值
   3. - [ ] 调整验证逻辑以适应编辑场景
2. - [ ] 创建编辑店铺对话框组件
   1. - [ ] 复用或扩展添加店铺对话框组件
   2. - [ ] 实现加载当前店铺数据的逻辑
   3. - [ ] 处理加载失败的错误状态
3. - [ ] 实现更新店铺 API 集成
   1. - [ ] 完善 lib/api/shop.ts 中的更新店铺 API
   2. - [ ] 在表单提交时调用更新 API
   3. - [ ] 实现加载状态和错误处理
4. - [ ] 更新店铺列表组件
   1. - [ ] 添加行级"编辑"按钮
   2. - [ ] 集成编辑店铺对话框
   3. - [ ] 实现编辑成功后的列表更新逻辑
5. - [ ] 样式优化和交互完善
   1. - [ ] 确保视觉一致性
   2. - [ ] 优化表单加载状态的显示

## Testing Requirements:

- 单元测试覆盖率 >= 85%
- 对编辑模式下的表单组件进行组件测试
- 测试编辑功能的 API 集成是否正确
- 测试数据加载和表单预填充的正确性
- 测试表单提交成功和失败的场景
- 验证编辑后列表更新的正确性
- 进行手动测试，验证用户交互体验

## Notes

- 尽可能复用添加功能中的组件和逻辑
- 编辑对话框标题应显示为"编辑店铺"
- 在加载店铺数据时显示加载状态
- 在提交编辑时需传递店铺 ID
- 参考 v0dev 生成的店铺添加/编辑对话框组件设计
- 所有输入控件使用全宽设计，与添加表单保持一致
